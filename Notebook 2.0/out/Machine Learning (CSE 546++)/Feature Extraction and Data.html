<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>&midast;&midast;Intro&midast;&midast;</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 12px;
                line-height: 1;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <p>Sometimes, we need to transform data that are not presented in vector so that some of the the models we developed can use that data.</p>
<hr>
<h3 id="intro"><strong>Intro</strong></h3>
<p>People should know how to deal with data when we do machine learning.</p>
<p>Data type:</p>
<ol>
<li>Paragraph</li>
<li>Tree with labels</li>
<li>Categorical, tags</li>
<li>Audio</li>
<li>Time Series</li>
</ol>
<p>These are not just vectors or matrices.</p>
<p><strong>What if there are Uninformative features in data?</strong></p>
<ol>
<li>Lasso</li>
<li>Find new data if it's just not useful</li>
</ol>
<p><strong>What if there are correlations in the features?</strong></p>
<ol>
<li>PCA decorrelation on features.</li>
<li>Feature selection using LASSO.</li>
</ol>
<hr>
<h3 id="real-vectors"><strong>Real Vectors</strong></h3>
<p>Pre-Processing Piplines:</p>
<ol>
<li>Standardization
<ol>
<li>Standardize across all the features <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, so that they are zero mean and unit variance. If considering row data matrix:</li>
<li></li>
</ol>
</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>−</mo><mtext>mean</mtext><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mtext>axis</mtext><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mtext>keepdim</mtext><mo>=</mo><mtext>True</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mtext>std</mtext><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mtext>axis</mtext><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mtext>keepdim</mtext><mo>=</mo><mtext>True</mtext><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">    \frac{(X - \text{mean}(X, \text{axis}=0, \text{keepdim}=\text{True}))}{\text{std}(X, \text{axis}=0, \text{keepdim}=\text{True})}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">std</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">axis</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">keepdim</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord text"><span class="mord">True</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord text"><span class="mord">mean</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">axis</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">keepdim</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord text"><span class="mord">True</span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ol start="2">
<li>Principal components projection</li>
</ol>
<p>Apply this exact transformation on the test set using parameters we got from the training set. <strong>Don't get standardization parameters from the test data!</strong></p>
<p>When using PCA, the principal components should be from the training data for embedding features from the test data set.</p>
<p>! <strong>Warning:</strong></p>
<blockquote>
<p>When using PCA for de-correlations, make sure the data is ZERO MEAN</p>
</blockquote>
<p>Another more involved version will involve the use of [[Auto Encoder]], a generalized version of the PCA, using non-linear transformation.</p>
<p>This is often used when there are a lot of redundant feature
in the data set.</p>
<hr>
<h3 id="categorical-data"><strong>Categorical Data</strong></h3>
<p>Representing categorical data using Canonical Data.</p>
<p>Say categorical label <code>color</code> has labels: Red, Green, Blue.</p>
<p>Then red can be encoded as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[1, 0, 0]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>, green and blue as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup><mo separator="true">,</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[0, 1, 0]^T, [0, 0, 1]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>This makes all the color complete independent from each other. This is good, sometimes. This is called: <strong>Unstructured Encoding</strong>, this representation won't create the problem of say: red + green = blue, if we use: red = 1, green = 2, blue = 3.</p>
<p><strong>Ok, what if we have zip code as categorical data?</strong></p>
<p>Using Unstructured encoding is not good, because in that case the features vector will be too large.</p>
<p>Instead, we are going to use some prior knowledge about zip code.</p>
<p>We have to encode group of zip code into one feature. Say, zip code from one region all get encoded into a unique label, boolean label I think.</p>
<hr>
<h3 id="structured-data-tree-graph"><strong>Structured Data: Tree, Graph</strong></h3>
<p>Say we were given a tree/graph that has a lot of labels in each node.</p>
<p>Then, the distance between 2 node could be the shortest path between these 2 nodes in the graph.</p>
<p>And then in that case, we an carry out Clustering on the graph, Base on the distance between all the nodes.</p>
<p>Distance: The smaller number of edges between any 2 nodes in the graph.</p>
<p>Using the unsupervised learning to cluster it, then we can assign labels to cluster. And that will be our feature embedding for nodes in the graph.</p>
<hr>
<h3 id="images"><strong>Images</strong></h3>
<p>This is call computer vision, and if we want to extrac features from the images, we will be using Deep Neural Networks.</p>
<p>Before the age of deep learning, people have hand-crafted filters and algorithm for extracting features.</p>
<p>Nowadays, we use deep learning to get learned features from the data set.</p>
<p><strong>The key is</strong></p>
<blockquote>
<p>The Conv2d, Maxpool, function that comes right before the VISION Neural Networks are features extractor.</p>
</blockquote>
<p>After all the layers of Convolution and Maxpool, the output right before the dense layer will be an embeddings of features, trained using the trained set.</p>
<p>we can use: AlexNet, Resnet.</p>
<p>Steps:</p>
<ol>
<li>Train the Resnet Model on ImageNet data set.</li>
<li>There is a linear classifier on the Resnset.</li>
<li>Then we can use all other layers as a feature extractor, and then stick a new classifier or model you had on the end and then train it again.</li>
</ol>
<p>Note:</p>
<ul>
<li>We can train the feature extractor together with the Custom Layers you made.</li>
</ul>

    </body>
    </html>