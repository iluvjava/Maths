<!DOCTYPE html>
<html>
<head>
<title>Convex Conjugation.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<p>Pre-requisite:</p>
<ul>
<li><a href="../Background/Characterizing%20Functions%20for%20Optimizations.md">Characterizing Functions for Optimizations</a></li>
<li><a href="../CVX%20Analysis/Support%20Function.md">Support Function</a></li>
<li><a href="../Non-Smooth%20Calculus/Subgradient%20and%20Subdifferential%20Definition.md">Subgradient and Subdifferential Definition</a></li>
</ul>
<hr>
<h3 id="intro"><strong>Intro</strong></h3>
<p>Convex conjugate is Fenchel conjugate, It's also called the Fenchel Legendre Transform. The below information is from the internet and the AMATH 515 class I took. There are several important things regarding convex conjugate functions:</p>
<ol>
<li>The conjugate function are the slope and offset of supporting halfspace that supports the original function from the bottom.</li>
<li>The conjugate function closes the epigraph of the original function and it also creates a convex envelope for it.</li>
<li>It's convex.</li>
<li>Convex conjugate function is related to the subgradient.</li>
</ol>
<p><strong>Definition</strong></p>
<blockquote>
<p>Let $f(x): \mathbb{R}^n \mapsto \mathbb{R} \cup {-\infty, \infty}$, then the Fenchel Conjugate is defined to be:
$$
f^\star(y) = \sup_{x \in E} \left\lbrace
y^Tx - f(x)
\right\rbrace
$$</p>
</blockquote>
<p><strong>Notations</strong></p>
<p>For clear notations, we will present conjugating a function wrt to a specific parameter for an expression, and show what inputs are given. For example, taking the conjugation of $f(Ax + b, y)$ wrt to $x$ and evaluating the conjugate at $z$ is denoted as:</p>
<p>$$
\begin{aligned}
{[f(Ax + b, y)|x]}^\star(z)
\end{aligned}
$$</p>
<p><strong>Remarks</strong>:</p>
<p>The conjugate function is always convex, see the next section for more info. We prove it by presenting the convex conjugate of any function as a support function on the epigraph of the function over $\mathbb E\times \mathbb R$.</p>
<hr>
<h3 id="conjugate-epigraph-contains-all-affine-minorants-of-the-original-function"><strong>Conjugate Epigraph Contains all Affine Minorants of the Original Function</strong></h3>
<blockquote>
<p>$\forall (y, \alpha) \in {\text{epi}}(f^\star)$, we have the claim that $f(x) \ge \langle y, x\rangle - \alpha$</p>
</blockquote>
<p>Please observe that the vector from $\text{epi}(f)$ is the slope of a supporting hyperplane of the original function $f(x)$. The relation between original and conjugate function can be expressed as: $f(x)\ge y^Tx - f^\star(y)$. This is refers to as the <em>Cauchy Subgradient inequality</em> or <em>Fenchel inequality</em>.</p>
<p><strong>Justification</strong></p>
<p>Directly from the definition of the conjugate function we state:</p>
<p>$$
\begin{aligned}
&amp; \forall (y, \alpha) \in \text{epi}(f^\star)
\
&amp; \alpha \ge f^\star(y) \ge \langle y, x\rangle - f(x) \quad \forall x,y
\
\implies &amp;
f(x) \ge \langle y, x\rangle - \alpha
\end{aligned}
$$</p>
<p><strong>Remarks</strong></p>
<p>The conjugate function $f^\star(x)$'s value provides the least offset of the affine functions that is below the functon $f$, given the slope of the affine function.</p>
<p>In fact, one can go on and make the claim the the epigraph of the original function is contains within all the halfspaces defined by the convex conjugate functions. Therefore, using the above inequality, we can easily obtain that:</p>
<p>$$
\begin{aligned}
&amp; \forall (x, \beta)\in \text{epi}(f), (y, \alpha)\in \text{epi}(f^\star)
\
&amp;
\beta \ge f(x)\ge \langle y, x\rangle - \alpha
\
\implies &amp;
\text{epi(f)} \subseteq
\bigcap_{(y, \alpha)\in \text{epi}(f^\star)}{(x, \beta): \beta \ge \langle y, x\rangle - \alpha}
\end{aligned}
$$</p>
<p>And it's not hard to see that the epigraph is described by intersection of all possible halfspaces, giving us a convex set in the end. However, the hard part to justify here is $\text{cl}\circ\text{cvxh}\circ \text{epi}(f)$ equals to the intersection of all the affine minorants defined by the epigraph of the convex conjugate functions.</p>
<p><strong>Theorem: Conjugate is the Support Function of the Epigraph of $f$</strong></p>
<blockquote>
<p>The support function over the epigraph of function $f$ is the conjugate function $f^\star$, but in a high dimension. To quantify the epigraph, Define the convex indicator over the epigraph:</p>
</blockquote>
<p>$$
\delta_Q(x) := \begin{cases}
0 &amp; x \in Q
\
+\infty  &amp;x \not\in Q<br>
\end{cases}
$$</p>
<p>Recall the definition from the support functions and consider:</p>
<p>$$
\begin{aligned}
f^\star(x) &amp;= \sup_y{\langle y, x\rangle - f(y)}
\
&amp;= \sup_{y} \left\lbrace
\left\langle
\begin{bmatrix}
y\ f(y)
\end{bmatrix}
,
\begin{bmatrix}
x \ -1
\end{bmatrix}
\right\rangle
\right\rbrace
\
&amp;=
\sup_{z\in \text{epi}(f)}
\left\lbrace
\left\langle
z,
\begin{bmatrix}
x
\
-1
\end{bmatrix}
\right\rangle
\right\rbrace
\
&amp;=
\delta^\star_{\text{epi}(f)}\left(
\begin{bmatrix}
x \ - 1
\end{bmatrix}
\right)
\end{aligned}
$$</p>
<p>From the first line the the second line, we make the intuitive argument that the finite value for supremum is always attain at the boundary of the epigraph, then using that we construct $z = [y ;f(y)]^T$ to denote it. And finally we arrive at the fact that, the conjugate function is the suppotr function for $\text{epi}(f)$, along the vector $[x; - 1]^T$.</p>
<p><strong>Corollary: Convex Conjugate is Convex</strong></p>
<p>Using the fact that the support function of any set is closed and convex (which is proved in: <a href="../CVX%20Analysis/Support%20Function.md">Support Function</a>) and the above representation of conjugate function via the support function, we know that the conjugate funciton is also closed and convex.</p>
<p><strong>Remarks</strong></p>
<p>Using this property, we can make shortcut to finding the conjugates of some functions that has a nice epigraphical interpretation, one of the great example would be the pointwise maximum function, or the infimal convolutions.</p>
<hr>
<h3 id="geometric-interpretations"><strong>Geometric Interpretations</strong></h3>
<p><img src="../../fenchel_transform_interpretations.png.png" alt="fenchel_transform_interpretations.png"></p>
<blockquote>
<p>The dual variable is the slope of the tangent line and the value of the function is the negative of the y intersect (or whatever intersect on the higher dimension).</p>
</blockquote>
<p><strong>Observe</strong></p>
<p>Given $z$ the dual varible, representing the slope of the line I want to &quot;touch&quot; the function $f$ at its lowest point, then $f^\star(z)$ gives me exactly the negative y intersect I need to move my line $z^Tx$ to touch $f$, at the point $x$, the dual variable.</p>
<hr>
<h3 id="bi-conjugation"><strong>Bi-Conjugation</strong></h3>
<p><strong>Theorem: Biconjugate Function is Always Smaller</strong></p>
<blockquote>
<p>$$
f^{\star\star}(x) \le f(x)
$$</p>
</blockquote>
<p>Such a claim make sense geometrically, a convex envelop is reconstructed using the conjugate of the original function, and it will always be smaller in quantity.</p>
<p><strong>Proof</strong></p>
<p>$$
\begin{aligned}
f^{\star\star}(z) = \sup_x \left\lbrace
z^Tx - f^\star(x)
\right\rbrace
&amp; =
\sup_x \left\lbrace
z^Tx - \sup_{y} \left\lbrace
z^Ty - f(y)
\right\rbrace
\right\rbrace
\\underset{[1]}{\implies}
\sup_x \left\lbrace
\inf_{y} \left\lbrace
z^T(x - y) + f(y)
\right\rbrace
\right\rbrace
&amp;\le \inf_y
\left\lbrace
\sup_x \left\lbrace
z^T(x - y) + f(y)
\right\rbrace
\right\rbrace
\end{aligned}
$$</p>
<p><a href="MinMax%20MaxMin%20Lemma.md">MinMax MaxMin Lemma</a></p>
<p><strong>Corollary: The Biconjugate Theorem</strong></p>
<blockquote>
<p>$$
\text{epi}(f^{\star\star}) = \text{cl}\circ \text{cvxh}\circ\text{epi}(f)
$$
The epigrah of the biconjugate function is the closure of the convex hull of the epigraph of the original function.</p>
</blockquote>
<p><strong>Proof</strong></p>
<p>See <a href="Biconjugate%20Theorem.md">Biconjugate Theorem</a> for a more detailed proof of the theorem.</p>
<hr>
<h3 id="convex-conjugate-quick-maths-references"><strong>Convex Conjugate Quick Maths References</strong></h3>
<p>In this section we list some important quick rules for computing the convex onjugation of functions.</p>
<p>$$
\begin{array}{|c|c|c|c|}
\hline f(x) &amp; \operatorname{dom} f &amp; f^{\star}(y) &amp; \operatorname{dom} f^{\star} \
\hline \hline|x| &amp; \mathbb{R} &amp; 0 &amp; {[-1,1]} \
\hline \frac{1}{p}|x|^{p}, p&gt;1 &amp; \mathbb{R} &amp; \frac{1}{q}|y|^{q} \quad\left(\frac{1}{p}+\frac{1}{q}=1\right) &amp; \mathbb{R} \
\hline \sqrt{1+x^{2}} &amp; \mathbb{R} &amp; -\sqrt{1-y^{2}} &amp; {[-1,1]} \
\hline-\log (x) &amp; (0, \infty) &amp; -1-\log (-y) &amp; (-\infty, 0) \
\hline e^{x} &amp; \mathbb{R} &amp; y \log (y)-y &amp; {[0, \infty)} \
\hline x \log (x) &amp; (0, \infty) &amp; e^{y}-1 &amp; \mathbb{R} \
\hline \log \left(1+e^{x}\right) &amp; \mathbb{R} &amp; y \log (y)+(1-y) \log (1-y) &amp; {[0,1]} \
\hline
\end{array}
$$</p>
<p>And these are some of the quick rules for computations:</p>
<p>$$
\begin{array}{|c|c|}
\hline \text { Function } h(x) &amp; \text { Fenchel conjugate } h^{\star}(y) \
\hline \hline \lambda f(x) &amp; \lambda f^{\star}\left(\frac{y}{\lambda}\right) \
\hline f(x+b) &amp; f^{\star}(y)-\langle b, y\rangle \
\hline \inf <em>{z} g(x, z) &amp; g^{\star}(y, 0) \
\hline f \square g &amp; f^{\star}+g^{\star} \
\hline \inf <em>{y}{f(y): \mathcal{A} y=x} &amp; f^{\star}(\mathcal{A} y) \
\hline
\sum</em>{i = 1}^n g(x_i) &amp;
\sum</em>{i = 1}^n g^\star(x_i)
\
\hline
\end{array}
$$</p>
<p><strong>Remarks</strong>:</p>
<p>Entry 3: $g^\star$ is dualizing on both parameters $(x,z)$ for the function $g$.</p>
<p>And finally, the conjugate of the Indicator function of set $C$: $\delta_C^\star(x)$ is just the support function on the set $C$. In fact, for more special use of the conjugation, we must invoke the indicator function on epigraph of the function and use properties of the <a href="../CVX%20Analysis/Support%20Function.md">Support Function</a> to analyze the dual.</p>
<p>For more, actual examples with step by step derivations regarding the convex conjugate of functions, see <a href="Convex%20Conjugate%20Examples.md">Convex Conjugate Examples</a> for more information. Here we summarize some of the important results from there in a nice table format.</p>
<p>#TODO: FILL THIS IN! WE NEED MORE CONJUGATE EXAMPLES.</p>

</body>
</html>
