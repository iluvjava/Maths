- [FISTA Made Simple Part IV](FISTA%20Made%20Simple%20Part%20IV.md)

---
### **Intro**

The failure of previous parts kindled the old fashion approach of R-WAPG. 
Recall from previous materials on: 
1. Definition of similar triangle form of accelerated proximal gradient (ST-APG), on the sequence $((\alpha_k)_{k \ge 0}, (q_k)_{k \ge 0}, (B_k)_{k \ge 0}, (y_k)_{k \ge 0}, (x_k)_{k \ge -1}, (v_k)_{k \ge -1})$. 
2. Definition of generalized momentum sequence, on the sequences $q_k, \alpha_k, \rho_k$ for all $k \ge 0$, and their relations. We call this the **Relaxed Momentum Sequence Relations**. 

For a smooth plus nonsmooth objective $F = f + g$, recall the definitions of proximal gradient and gradient mapping operator: 

$$
\begin{aligned}
\end{aligned}
$$

If, the sequences $(y_k, x_k, v_k)_{k \ge 0}$ are generated by the similar triangle form of the accelerated proximal gradient (ST-APG). 
From previous section, we also have the following results. 

#### **Recall | Previous Results 1**
> We have for all $k \ge 0$, the following: 
> $$
> \begin{aligned}
>     v_{k} &= v_{k - 1} + \alpha_k^{-1}q_k(y_k - v_{k - 1}) - \alpha_{k}^{-1}B_k^{-1}\mathcal G_{B_k}(y_k), 
>     \\
>     y_k - v_{k - 1} &= 
>     \left(
>         \frac{1 - \alpha_k}{1 - q_k}
>     \right)(x_{k - 1} - v_{k - 1}), 
>     \\
>     y_k - x_{k - 1} &= 
>     \left(
>         \frac{\alpha_k - q_k}{1 - q_k}    
>     \right)(v_{k - 1} - x_{k - 1}). 
> \end{aligned}
> $$



---
### **Some new Definitions and Assumptions**

In preprations for a better proof of convergence on ST-APG, this section will propose several new definitions. 

#### **Definition | Proximal Gradient Gap**
> Let $F = f + g$ where $f$ is $L$ Lipschitz smooth and $g$ is convex. 
> Then the proximal gradient mapping $T_B(x) = \pprox{B^{-1}g}(x -  B^{-1}\nabla f(x))$ is a singleton, everywhere on $\R^n$. 
> Let parameter $\mu \ge 0$. 
> We define the proximal gradient gap $\mathcal E(z, y, \mu)$ is a $\R^n \times \R^n \rightarrow \R^n$ mapping by: 
> $$
> \begin{aligned}
>     \mathcal E(z, y, \mu, B) &:= 
>     F(z) - F(T_B(y)) 
>     - \left\langle B(y - T_B(y)), z - y\right\rangle
>     - \frac{\mu}{2}\Vert z - y\Vert^2
>     - \frac{B}{2}\Vert y - T_B(y)\Vert^2. 
> \end{aligned}
> $$

**Observations**. 

- In addition, if $f$ is $\mu \ge 0$ strongly convex, then $\mathcal E(z, y, \mu, B) \ge 0$ for all $z, y$. 
- When $f$ is convex, it has $\mathcal E (z, y, \mu, B) + \mu \Vert z - y\Vert^2 \ge 0$, for all $x, z$. 

#### **Assumptions 1 | for linear rate of convergence**
> The following assumption is about $(F, f, g, \mathcal E)$, it is the configuration we need to derive the convergence rate of ST-APG. 
> - Let $F = f + g$ such that $X^+ = \argmin{x} \{f(x) + g(x)\}$ has $X^+ \neq \emptyset$. 
> - For all $z \in \R^n$, there exists a $\mu > 0$ such that the proximal gradient gap satisfies $\mathcal E(\Pi_X^+(y), y, \mu) \ge 0$. 
> - For all $z, y \in \R^n$, it has $\mathcal E(z, y, \mu, B) + \frac{\mu}{2}\Vert z - y\Vert^2 \ge 0$. 


---
### **Preparting for the convergence rate proof**

This sections states intermediate results that we used to derive the convergence rate. 

#### **Lemma | Convergence Prep Part I**
> Suppose
> - The sequences $y_k, x_k, v_k$ satisfies ST-APG and, assume that it's that $(F, f, g, \mathcal E)$ satisfies **Assumption 1**. 
> - The sequences $(\alpha_k)_{k\ge 0}, (\rho_{k})_{k \ge 0}, (q_k)_{k \ge 0}$ satisfies the definition of relaxed momentum sequence.
> - The parameter $q_k$ has $q_k = \mu/B_k$, with $B_k > \mu$, for all $k \ge 0$. 
>
> Then, for all $\bar x \in \R^n$, $k \ge 0$: 
> $$
> \begin{aligned}
>     & 
>     \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
>     -\frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
>     \\
>     &=
>     \frac{\alpha_k \mu}{2}
>     \Vert \bar x - v_{k - 1}\Vert^2
>     + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert
>     + \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2
>        \\ &\quad 
>        - \langle
>           q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
>        \rangle
>         + \alpha_k \mu
>         \left\langle 
>             v_{k - 1} - \bar x, 
>             y_k - v_{k - 1}
>         \right\rangle. 
> \end{aligned}
> $$



**Proof**

Let $\bar x \in \R^n$ be arbitrary. We will establish major intermediate results (a), (b). 
Our first intermediate (a) starts by considering for all $k \ge 1$: 

$$
\begin{aligned}
    & \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
    \\
    &\underset{(1)}{=} \frac{B_k\alpha_k^2}{2}\left\Vert
        \bar x - 
        \left(
            v_{k - 1} 
            + \alpha_k^{-1}q_k(y_k - v_{k - 1})
            - \alpha_k^{-1} B_k^{-1} \mathcal G_{B_k}(y_k)
        \right)
    \right\Vert^2
    \\
    &= \frac{B_k\alpha_k^2}{2}\left\Vert
        (\bar x - v_{k - 1})
        - \alpha_k^{-1}\left(
            q_k(y_k - v_{k - 1})
            -  B_k^{-1} \mathcal G_{B_k}(y_k)
        \right)
    \right\Vert^2
    \\
    &= \frac{B_k\alpha_k^2}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{B_k}{2}\left\Vert 
        q_k(y_k - v_{k - 1})
        -  B_k^{-1} \mathcal G_{B_k}(y_k)
    \right\Vert^2
        \\ &\quad 
        - \alpha_k B_k
        \left\langle 
            \bar x - v_{k - 1}, 
            q_k(y_k - v_{k - 1}) - B_k^{-1}\mathcal G_{B_k}(y_k)
        \right\rangle
    \\
    &= 
    \frac{B_k\alpha_k^2}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{B_kq_k^2}{2}\Vert y_k - v_{k - 1} \Vert
    + \frac{1}{2B_k}\Vert \mathcal G_{B_k}(y_k)\Vert^2
    - q_k\langle 
        y_k - v_{k - 1}, \mathcal G_{B_k}(y_k)
    \rangle
        \\ &\quad 
        + B_k\alpha_k
        \left\langle 
            v_{k - 1} - \bar x, 
            q_k(y_k - v_{k - 1}) - B_k^{-1}\mathcal G_{B_k}(y_k)
        \right\rangle
    \\
    &= 
    \frac{B_k\alpha_k^2}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{B_kq_k^2}{2}\Vert y_k - v_{k - 1} \Vert
    + \frac{1}{2B_k}\Vert \mathcal G_{B_k}(y_k)\Vert^2
    - q_k\langle 
        y_k - v_{k - 1}, \mathcal G_{B_k}(y_k)
    \rangle
        \\ &\quad 
        + 
        B_k\alpha_k\left\langle 
            v_{k - 1} - \bar x, 
            q_k(y_k - v_{k - 1}) 
        \right\rangle
        - \alpha_k \left\langle 
            v_{k - 1} - \bar x,
            \mathcal G_{B_k}(y_k)
        \right\rangle
    \\
    &= 
    \frac{\alpha_k^2B_k}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{q_k^2B_k}{2}\Vert y_k - v_{k - 1} \Vert
    + \frac{1}{2B_k}\Vert \mathcal G_{B_k}(y_k)\Vert^2
        \\ &\quad 
        - \langle
            q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
        \rangle
        \\ &\quad 
        + \alpha_k q_k B_k
        \left\langle 
            v_{k - 1} - \bar x, 
            y_k - v_{k - 1}
        \right\rangle. 
\end{aligned}
$$

At **(1)**, we used first equality in **Previous Results**. 
Take the result of the equality chain and subtract $-\frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2$ from both sides, the coefficient for $\Vert \bar x - v_{k - 1}\Vert^2$ comes out to be: 

$$
\begin{aligned}
    & \frac{\alpha_k^2B_k}{2}
    - \frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2} 
    = \frac{B_k}{2}(
        \alpha_k^2 + (1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2
    )
    \underset{(1)}{=} \frac{B_k\alpha_kq_k}{2}. 
\end{aligned}
$$

At (1), we used the relation $(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2 = \alpha_k(\alpha_k - q_k)$, for all $k \ge 1$. 
Therefore we have the equality: 

$$
\begin{aligned}
    &
    \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
    -\frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
    \\
    &= 
    \frac{\alpha_k q_k B_k}{2}\Vert \bar x - v_{k - 1}\Vert^2
    + \frac{q_k^2B_k}{2}\Vert y_k - v_{k - 1} \Vert
    + \frac{1}{2B_k}\Vert \mathcal G_{B_k}(y_k)\Vert^2
        \\ &\quad 
        - \langle
            q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
        \rangle
        \\ &\quad 
        + \alpha_k q_k B_k
        \left\langle 
            v_{k - 1} - \bar x, 
            y_k - v_{k - 1}
        \right\rangle. 
    \\
    &\underset{(1)}{=} 
    \frac{\alpha_k \mu}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert
    + \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2
        \\ &\quad 
       - \langle
            q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
        \rangle
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            y_k - v_{k - 1}
        \right\rangle. 
\end{aligned}
$$
At (1), we used the relation that $B_k = \mu/q_k$, for all $k \ge 0$. 

$\blacksquare$

#### **Lemma | Convergence Prep Part II**
> The iterates $(y_k, x_k, v_k)_{k \ge 0}$ generated by the ST-APG algorithm satisfies for all $k \ge 0$ the following identities: 
> $$
> \begin{aligned}
>     \alpha_k(v_{k - 1} - \bar x) 
>     + q_k(y_k - v_{k - 1})
>     + x_{k - 1} - y_k
>     &= 
>     \alpha_k(x_{k - 1} - \bar x). 
> \end{aligned}
> $$

**Proof**

It directly has: 

$$
\begin{aligned}
    & 
    \alpha_k(v_{k - 1} - \bar x) 
    + q_k(y_k - v_{k - 1})
    + x_{k - 1} - y_k
    \\
    &\underset{(1)}{=}
    \alpha_k(v_{k - 1} - \bar x)
    + q_k\left(
        \frac{1 - \alpha_k}{1 - q_k}
    \right)(x_{k - 1} - v_{k - 1})
    - \left(
        \frac{\alpha_k - q_k}{1 - q_k}    
    \right)(v_{k - 1} - x_{k - 1}). 
    \\
    &= 
    \alpha_k(v_{k - 1} - \bar x)
    + (1 - q_k)^{-1}\left(
        q_k - q_k\alpha_k +(\alpha_k - q_k)
    \right)
    (x_{k - 1} - v_{k - 1})
    \\
    &= 
    \alpha_k(v_{k - 1} - \bar x)
    + \alpha_k(x_{k - 1} - v_{k - 1})
    \\
    &= \alpha_k(x_{k - 1} - \bar x). 
\end{aligned}
$$

At (1), we used the second and third equality from Previous Results. 
$\blacksquare$

#### **Lemma | Convergence Prep Part III**
> Suppose that 
> 1. $(F, f, g, \mathcal E)$ satisfies **Assumption 1**. 
> 2. The sequence $(\alpha_k)_{k \ge 0}, (\rho_k)_{k \ge 0}, (q_k)_{k \ge 0}$ satisfies **Relaxed Momentum Sequence Relations**. 

**Proof**

Set $z = x_{k - 1}$ for the Definition of Proximal Gradient Gap, from the ST-APG it makes $x_k = T_{B_k}(y_k)$, therefore for all $k \ge 0$: 

$$
\begin{aligned}
    \mathcal E(x_{k - 1}, y_k, \mu, B_k) &=
    F(x_{k - 1}) - F(x_k)
    - \langle 
        B_k(y_k - z_k), 
        x_{k - 1} - y_k
    \rangle
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    - \frac{B_k}{2}\Vert y_k - x_k\Vert^2
    \\
    &= 
    F(x_{k - 1}) - F(x_k)
    - \langle 
        \mathcal G_{B_k}(y_k), 
        x_{k - 1} - y_k
    \rangle
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    - \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2
\end{aligned}
$$

The second equality used $B^{-1}_k(y_k - x_k)= \mathcal G_{B_k}(y_k)$, and $B_k = \mu/q_k$.
For all $k \ge 0$, define $\Xi_k$ to be: 

$$
\begin{aligned}
    \Xi_k &= \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    + F(x_k) - F(\bar x)
    - (1 - \alpha_k)(F(x_{k - 1}) - F(\bar x))
    \\
    &= 
    \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    + F(x_k) - \alpha_kF(\bar x) - (1 - \alpha_k)F(x_{k - 1})
    \\
    &=
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \langle \mathcal G_{B_k}(y_k), x_{k - 1} - y_k\rangle
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
    - \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2. 
\end{aligned}
$$

then consider the new term $\Xi_k'$ which we defined as: 

$$
\begin{aligned}
    \Xi_k'
    &=
    \Xi_k + \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
    - \frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
    \\
    &\underset{(1)}{=} 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \langle \mathcal G_{B_k}(y_k), x_{k - 1} - y_k\rangle
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
    - \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2
        \\&\quad 
        + \frac{\alpha_k \mu}{2}
        \Vert \bar x - v_{k - 1}\Vert^2
        + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert^2
        + \frac{q_k}{2\mu}\Vert \mathcal G_{B_k}(y_k)\Vert^2
        \\ &\quad 
        - \langle
            q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
        \rangle
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            y_k - v_{k - 1}
        \right\rangle
    \\
    &= 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \langle \mathcal G_{B_k}(y_k), x_{k - 1} - y_k\rangle
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
        \\&\quad 
        + \frac{\alpha_k \mu}{2}
        \Vert \bar x - v_{k - 1}\Vert^2
        + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert^2
        \\ &\quad 
        - \langle
            q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), \mathcal G_{B_k}(y_k)
        \rangle
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            y_k - v_{k - 1}
        \right\rangle
    \\
    &= 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
    + \frac{\alpha_k \mu}{2}
    \Vert \bar x - v_{k - 1}\Vert^2
    + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert^2
        \\ &\quad 
        - \langle
            x_{k - 1} - y_k + q_k(y_k - v_{k - 1}) + \alpha_k(v_{k - 1} - \bar x), 
            \mathcal G_{B_k}(y_k)
        \rangle
        \\&\quad 
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            q_k(y_k - v_{k - 1}) 
        \right\rangle
    \\
    &\underset{(2)}{=} 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
        \\&\quad 
        + \frac{\alpha_k \mu}{2}
        \Vert \bar x - v_{k - 1}\Vert^2
        + \frac{q_k\mu}{2}\Vert y_k - v_{k - 1} \Vert^2
        \\ &\quad 
        - \alpha_k\langle
            x_{k - 1} - \bar x, 
            \mathcal G_{B_k}(y_k)
        \rangle
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            q_k(y_k - v_{k - 1}) 
        \right\rangle
    \\
    &=
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
        \\&\quad 
        + \frac{\alpha_k \mu}{2}
        \Vert \bar x - v_{k - 1}\Vert^2
        + \frac{\alpha_k\mu}{2}\Vert y_k - v_{k - 1}\Vert^2
        + \alpha_k \mu
        \left\langle 
            v_{k - 1} - \bar x, 
            q_k(y_k - v_{k - 1}) 
        \right\rangle
        \\ &\quad 
        - \alpha_k\langle
            x_{k - 1} - \bar x, 
            \mathcal G_{B_k}(y_k)
        \rangle
        + \frac{q_k\mu - \mu\alpha_k}{2}\Vert y_k - v_{k - 1} \Vert^2
    \\
    &= 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
        \\&\quad 
        \frac{\alpha_k\mu}{2}\Vert y_k - \bar x\Vert^2
        - \alpha_k\langle
            x_{k - 1} - \bar x, 
            \mathcal G_{B_k}(y_k)
        \rangle
        + \frac{q_k\mu - \mu\alpha_k}{2}\Vert y_k - v_{k - 1} \Vert^2
    \\
    &\underset{(3)}{\le} 
    \alpha_kF(x_{k - 1}) - \alpha_k F(\bar x)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2 
        \\&\quad 
        \frac{\alpha_k\mu}{2}\Vert y_k - \bar x\Vert^2
        - \alpha_k\langle
            x_{k - 1} - \bar x, 
            \mathcal G_{B_k}(y_k)
        \rangle. 
    \\
    &= \alpha_k\left(
        F(x_{k  - 1}) - F(\bar x) 
        - \langle x_{k - 1} - \bar x, \mathcal G_{B_k}(y_k)\rangle
        +  \frac{\mu}{2}\Vert y_k - \bar x\Vert^2
    \right)
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2. 
\end{aligned}
$$

At (1), we used Convergence Prep Part I. 
At (2) we used Convergence Prep Part II to simplified the inner product containing $\mathcal G_{B_k}(y_k)$. 
At (3), is true because $\alpha_k > q_k$ by the definition of a relaxed momentum sequence hence it makes the coefficient of $\Vert y_k - v_{k - 1}\Vert^2$ negative. 
Now, consider subtracting $\mathcal E(x_{k - 1}, y_k, \mu, B_k)$ from both sides of the inequality which yields: 

$$
\begin{aligned}
    & \Xi_k' - \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &\le 
    \alpha_k\left(
        F(x_{k  - 1}) - F(\bar x) 
        - \langle x_{k - 1} - \bar x, \mathcal G_{B_k}(y_k)\rangle
        +  \frac{\mu}{2}\Vert y_k - \bar x\Vert^2
        - \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \right)
        \\ &\quad 
        - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
        - (1 - \alpha_k)\mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &\underset{(1)}{=} 
    \alpha_k\left(
        F(x_k) - F(\bar x) 
        - \langle \mathcal G_{B_k}(y_k), x_{k - 1} - \bar x - (x_{k - 1} - y_k)\rangle
        + \frac{\mu}{2}\Vert y_k - \bar x\Vert^2
        + \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
        + \frac{B_k}{2} \Vert y_k - x_k\Vert^2
    \right)
        \\ &\quad 
        - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
        - (1 - \alpha_k)\mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &= \alpha_k\left(
        F(x_k) - F(\bar x) 
        - \langle \mathcal G_{B_k}(y_k), y_k - \bar x\rangle
        + \frac{\mu}{2}\Vert y_k - \bar x\Vert^2
        + \frac{B_k}{2} \Vert y_k - x_k\Vert^2
        + \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    \right)
        \\ &\quad 
        - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
        - (1 - \alpha_k)\mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &=
    \alpha_k\left(
        - \mathcal E(\bar x, y_k, \mu, B_k)
        + \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    \right)
        \\ &\quad 
        - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
        - (1 - \alpha_k)\mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &\underset{(2)}{\le} 
    \frac{\alpha_k \mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    - \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    - (1 - \alpha_k)\mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &= -(1 - \alpha_k)\left(
        \mathcal E(x_{k - 1}, y_k, \mu, B_k)
        + \frac{\mu}{2}\Vert x_{k - 1} - y_k\Vert^2
    \right) 
    \\
    & \underset{(3)}{\le} 0. 
\end{aligned}
$$

At (1), we substituted the definition ofr $\mathcal E(x_{k - 1}, y_k, \mu, B_k)$. 
At (2), we used the fact that $\bar x = \Pi_{X^+} y_k$ hence using Assumption 1 it makes $-\mathcal E(\bar x, y_k, \mu, B_k) \le 0$. 
At (3), we used assumption 3 so that $\mathcal E(x_{k - 1}, y_k, \mu, B_k) \ge 0$. 
Therefore, we had shown the following inequality: 

$$
\begin{aligned}
    & \Xi_k' - \mathcal E(x_{k - 1}, y_k, \mu, B_k) 
    \\
    &= 
    \Xi_k 
    + \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
    - \frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
    - \mathcal E(x_{k - 1}, y_k, \mu, B_k) 
    \\
    &= \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    + F(x_k) - F(\bar x)
    - (1 - \alpha_k)(F(x_{k - 1}) - F(\bar x))
        \\ &\quad 
        + \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
        - \frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
        - \mathcal E(x_{k - 1}, y_k, \mu, B_k)
    \\
    &=  
    + F(x_k) - F(\bar x)
    - (1 - \alpha_k)(F(x_{k - 1}) - F(\bar x))
        \\ &\quad 
        + \frac{B_k\alpha_k^2}{2}\Vert \bar x - v_k\Vert^2 
        - \frac{B_k(1 - \alpha_k)\rho_{k - 1}\alpha_{k - 1}^2}{2}\Vert \bar x - v_{k - 1}\Vert^2
    \\
    &\le 0. 
\end{aligned}
$$

